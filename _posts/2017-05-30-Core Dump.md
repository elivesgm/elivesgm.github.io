---
layout: post
title: "Core Dump"
date: 2017-05-30 16:02:00 
description: "Core file"
tag: Operating System
---


### 1. Core file

#### 1.1 Introduction

[Core file](https://en.wikipedia.org/wiki/Core_dump)是操作系统在进程收到某些信号而终止运行时，将此时进程地址空间的内容以及有关进程状态的其他信息写出的一个磁盘文件。这种信息往往用于调试。

>In computing, a core dump (in Unix parlance), memory dump, or system dump consists of the recorded state of the working memory of a computer program at a specific time, generally when the program has crashed or otherwise terminated abnormally. In practice, other key pieces of program state are usually dumped at the same time, including the processor registers, which may include the program counter and stack pointer, memory management information, and other processor and operating system flags and information[1].

#### 1.2 Format

>In older and simpler operating systems, each process had a contiguous address-space, so a core dump file was simply a binary file with the sequence of bytes or words. In modern operating systems, a process address space may have gaps, and share pages with other processes or files, so more elaborate representations are used; they may also include other information about the state of the program at the time of the dump[1].

- In Unix-like systems, core dumps generally use the standard executable image-format:
    - a.out in older versions of Unix,
    - ELF in modern Linux, System V, Solaris, and BSD systems,
    - Mach-O in macOS, etc.

- Windows supports two memory dump formats:
    - Kernel-mode dumps, includes, Complete memory dump – contains full physical memory for the target system.
Kernel memory dump – contains all the memory in use by the kernel at the time of the crash.
Small memory dump – contains various info such as the stop code, parameters, list of loaded device drivers, etc.
    - User-mode memory dumps, also known as minidump, is a memory dump of a single process. 

#### 1.3 产生core file的信号

以linux为例。信号是一种异步事件处理的机制，每种信号对应有其默认的操作，你可以在[这里](http://man7.org/linux/man-pages/man7/signal.7.html) 查看 Linux 系统提供的信号以及默认处理。默认操作主要包括忽略该信号（Ingore）、暂停进程（Stop）、终止进程（Terminate）、终止并发生core dump（core）等。如果我们信号均是采用默认操作，那么，以下列出几种信号，它们在发生时会产生 core dump:

| Signal   | Value |  Action |        Comment            |
|----------|-------|---------|---------------------------|
|:---      |:--:   |:--:     |:---                       |
| SIGQUIT  |   3   |   Core  |  Quit from keyboard       |
|SIGILL    |   4   |   Core  | Illegal Instruction       |
|SIGABRT   |   6   |   Core  | Abort signal from abort(3)|
|SIGFPE    |   8   |   Core  | Floating-point exception  |
|SIGSEGV   |   11  |   Core  | Invalid memory reference  |





### References:

[1] [Core Dump](https://en.wikipedia.org/wiki/Core_dump), wikipedia.
